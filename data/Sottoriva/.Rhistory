seq()
seq()
seq(10)
seq(100)
seq.int(100)
seq.int(1000)
seq.int(10000)
seq.int(100000)
62000/0.2
install.packages("nmf")
install.packages("NMF", type = 'soure')
install.packages("NMF", type = 'source')
table_S3 <- read.delim("~/Dropbox/dp/nature10933-s2/table_S3.txt")
View(table_S3)
head(table_S3)
table_S9 <- read.delim("~/Dropbox/dp/nature10933-s2/table_S9.tsv", header=F)
View(table_S9)
SRR385941.cellular_frequencies.tsv <- read.delim("~/Dropbox/dp/PyClone-0.12.0/examples/mixing/trace/pyclone_beta_binomial/all/SRR385941.cellular_frequencies.tsv.bz2")
View(SRR385941.cellular_frequencies.tsv)
pyclone_beta_binomial_cell_freq <- read.csv("~/Dropbox/dp/tssb/pyclone_beta_binomial_cell_freq.csv", header=F)
View(pyclone_beta_binomial_cell_freq)
x1 = SRR385941.cellular_frequencies.tsv
x2 = pyclone_beta_binomial_cell_freq
library('coda')
filename = './pyclone_beta_binomial_traces.csv'
traces <- read.csv(filename)
mcmc_converter <- function(traces, burnin){
numsamp = dim(traces)[1]
numvar = dim(traces)[2]
output = lapply(1:numvar, function(nvar)
as.mcmc(traces[(burnin+1):numsamp, nvar]) )
return( output )
}
plot(stet)
plot(x2[,1], x2[,2])
plot(x1[,1], x1[,2])
plot(x2[,1], x2[,2])
plot(x2[,1], type='l')
plot(x2[,2], type='l')
plot(x1[,2], type='l')
plot(x2[,2], type='l')
plot(x2[,3], type='l')
plot(x2[,4], type='l')
plot(x2[,5], type='l')
hist(x2[,5],100)
hist(x2[,5],100)
hist(x2[,55],100)
hist(x2[,65],100)
hist(x2[,5],100)
hist(x2[,1],100)
hist(x2[,2],100)
hist(x2[,3],100)
hist(x2[,4],100)
556.12 + 390.66
556.12+390.66-1187.75
hist(x2[,5],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,5],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[,5],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,5],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[,5],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,5],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x1[,5],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,5],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,5],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,50],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,100],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,101],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,1],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,2],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,3],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,4],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,5],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,2],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,100],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,120],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,130],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,140],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,131],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,132],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
hist(x2[1000:20000,133],100, xlab='celluar prevalence', main='NA12878:AB:chr7:55268949' )
for (ii = 1:140) { hist(x2[,ii]),100}
for (ii in 1:140) { hist(x2[,ii]),100}
for (ii in 1:140) { hist(x2[,ii],100)}
for (ii in 1:140) { hist(x2[,ii],100, main = as.character(ii)) }
ii = 23
hist(x2[,ii],100, main = as.character(ii))
pyclone_beta_binomial_cell_freq <- read.csv("~/Dropbox/dp/tssb/pyclone_beta_binomial_cell_freq.csv", header=F)
View(pyclone_beta_binomial_cell_freq)
x = pyclone_beta_binomial_cell_freq
ii = 23
hist(x[,ii],100, main = as.character(ii))
for (ii in 1:140) { hist(x[,ii],100, main = as.character(ii)) }
hist(x[1000:2e4,112],100, main = 'NA18507:BB:chr5:140603248')
hist(x[1000:2e4,112],100, main = 'NA18507:BB:chr5:140603248', xlab='Cellular Prevalence')
hist(x[1000:2e4,112],100, main = 'NA18507:BB:chr11:71717300', xlab='Cellular Prevalence')
hist(x[1000:2e4,115],100, main = 'NA18507:BB:chr11:71717300', xlab='Cellular Prevalence')
hist(x[1000:2e4,118],100, main = 'NA12878:BB:chr9:86278913', xlab='Cellular Prevalence')
hist(x[1000:2e4,124],100, main = 'NA12878:BB:chr3:49156473', xlab='Cellular Prevalence')
SRR385941 <- read.delim("~/Dropbox/dp/PyClone-0.12.0/examples/mixing/tsv/SRR385941.tsv")
View(SRR385941)
unique(SRR385941$variant_freq)
unique(SRR385941$variant_case)
test_beta_binomial_cell_freq <- read.csv("~/Dropbox/dp/tssb/test_beta_binomial_cell_freq.csv", header=F)
View(test_beta_binomial_cell_freq)
test_beta_binomial_traces <- read.csv("~/Dropbox/dp/tssb/test_beta_binomial_traces.csv")
View(test_beta_binomial_traces)
x1 = test_beta_binomial_cell_freq
x2 = test_beta_binomial_traces
matplot(1:20000, x1[,1:5])
plot(x2[,4],type='l')
plot(x2[1000:20000,4],type='l')
plot(x2[1000:20000,6],type='l')
hist(x2[1000:20000,6])
hist(x2[,1],100)
hist(x2[,1],1000)
hist(x2[,2],1000)
plot(x2[,1],type='l')
plot(x2[1000:20000,1],type='l')
pyclone_beta_binomial_cell_freq <- read.csv("~/Dropbox/dp/tssb/pyclone_beta_binomial_cell_freq.csv", header=F)
View(pyclone_beta_binomial_cell_freq)
x = pyclone_beta_binomial_cell_freq
meanx = x
meanx = mean(x)
meanx = colMeans(x)
meanx
plot(meanx)
plot(meanx, type='l')
unique(meanx)
write.table(meanx, file='../TrAp/tree-pyclone.csv', row.names= F)
write.csv(meanx, file='~/Dropbox/dp/TrAp/tree-pyclone.csv', row.names= F)
meanx = sort(meanx)
meanx
plot(meanx)
beta_binomial_cell_freq <- read.csv("~/Dropbox/dp/tssb/beta_binomial_cell_freq.csv", header=F)
View(beta_binomial_cell_freq)
x = beta_binomial_cell_freq
meanx = sort(colMeans(x))
plot(meanx)
write.csv(meanx, file='~/Dropbox/dp/TrAp/tree-beta-binomial.csv', row.names= F)
unique(meanx)
setwd('Dropbox/dp/tssb/data/')
dir()
setwd('Sottoriva/')
dir()
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/Dropbox/dp/tssb/data/Sottoriva/dat2binary.R')
source('~/Dropbox/dp/tssb/data/Sottoriva/dat2binary.R')
x<- read.table("~/Dropbox/dp/tssb/data/Sottoriva/ZZpaired_ZNF454.dat",
quote="\"", sep = ',')
x = as.matrix(x)
xx = sapply(1:length(x), function(ii) strsplit(x[ii,1], " " ))
idx = vector()
for (ii in 1:length(xx)){
if ( length(xx[[ii]]) > 2 ){
idx = rbind(idx, ii)
}
}
data = vector('list', length(idx))
for (ii in 2: length(idx)){
selected = (idx[ii-1] + 1) : (idx[ii] - 1)
tmp = vector()
for (jj in selected){
tmp = rbind(tmp, xx[[jj]])
}
data[[ii-1]] = tmp
}
tmp = vector()
for (ii in ( idx[ length(idx) ] + 1 ) : length(xx) ){
tmp = rbind(tmp, xx[[ii]])
}
data[[length(idx)]] = tmp
data
length(data)
for (ii in 1:1){
t = data[[ii]]
t1 = sapply(1:dim(t)[1], function(jj) unlist( strsplit( t[jj,1], '' )  )   )
t2 = unlist(t1)
}
t1
t1 = c(t1)
for (ii in 1:1){
t = data[[ii]]
t1 = sapply(1:dim(t)[1], function(jj) unlist( strsplit( t[jj,1], '' )  )   )
t2 = unlist(t1)
}
t1 = t(t1)
t1
t2 = c(t1,t[,2])
t2
cbind(t1,t[,2])
source('~/Dropbox/dp/tssb/data/Sottoriva/dat2binary.R')
data
source('~/.active-rstudio-document')
data
dir()
dir('~/Dropbox/dp/tssb/data/Sottoriva/')
dir('~/Dropbox/dp/tssb/data/Sottoriva/',pattern = '.dat')
for (nfile in file_name){
print(nfile)
}
file_name = dir('~/Dropbox/dp/tssb/data/Sottoriva/',pattern = '.dat')
for (nfile in file_name){
print(nfile)
}
x<- read.table(nfile,
quote="\"", sep = ',')
x
nfile
tmp_name = substr(nfile, 1, nchar(nfile)-4   )
tmp_name
paste( tmp_name, ii)
paste( tmp_name, ii, '.csv', sep='')
paste( tmp_name, '-' ii, '.csv', sep='')
paste( tmp_name, '-', ii, '.csv', sep='')
source('~/Dropbox/dp/tssb/data/Sottoriva/dat2binary.R')
tmp = vector()
for (jj in 1:dim(t2)[1]){
tmp = rbind(tmp, matrix(t2[jj,-dim(t2)[2]])
}
tmp = vector()
for (jj in 1:dim(t2)[1]){
tmp = rbind(tmp, matrix(t2[jj,-dim(t2)[2]])
}
repmat <- function(a,n,m) {kronecker(matrix(1,n,m),a)}
tmp = vector()
for (jj in 1:dim(t2)[1]){
tmp = rbind(tmp, repmat(t2[jj,-dim(t2)[2]]),t2[jj,dim(t2)[2]],1)
}
tmp = vector()
for (jj in 1:dim(t2)[1]){
tmp = rbind(tmp, repmat(t2[jj,-dim(t2)[2]],t2[jj,dim(t2)[2]],1)
}
tmp = vector()
for (jj in 1:dim(t2)[1]){
tmp = rbind(tmp, repmat(t2[jj,-dim(t2)[2]],t2[jj,dim(t2)[2]],1))
}
t2
t2[jj,-dim(t2)[2]]
repmat(t2[jj,-dim(t2)[2]],t2[jj,dim(t2)[2]],1)
ttt = t2[jj,-dim(t2)[2]]
ttt
class(t2) = 'numeric'
tmp = vector()
for (jj in 1:dim(t2)[1]){
tmp = rbind(tmp, repmat(t2[jj,-dim(t2)[2]],t2[jj,dim(t2)[2]],1))
}
tmp
repmat(t2[jj,-dim(t2)[2]],t2[jj,dim(t2)[2]],1)
ttt = t2[jj,-dim(t2)[2]]
View(`t2`)
tmp1 = t2[jj,-dim(t2)[2]]
tmp1 = as.matrix(t2[jj,-dim(t2)[2]])
tmp1 = t(as.matrix(t2[jj,-dim(t2)[2]]))
tmp1
jj
t2
t2[jj,dim(t2)[2]]
repmat(tmp1,t2[jj,dim(t2)[2]],1)
tmp = vector()
for (jj in 1:dim(t2)[1]){
tmp1 = t(as.matrix(t2[jj,-dim(t2)[2]]))
tmp = rbind(tmp, repmat(tmp1,t2[jj,dim(t2)[2]],1))
}
View(tmp)
View(x)
tmp[1:35,]
tmp[1:38,]
tmp[1:39,]
source('~/Dropbox/dp/tssb/data/Sottoriva/dat2binary.R')
